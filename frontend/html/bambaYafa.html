<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta ="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Dashboard</title>
    <link rel="stylesheet" href="../css/bambaYafa-desktop.css" />
    <link
      href="https://fonts.googleapis.com/css2?family=Raleway"
      rel="stylesheet"
    />
    <script type="module" defer src="../js/controller.js"></script>
  </head>
  <body id="bambot">
    <svg version="1.1" xmlns="http://www.w3.org/2000/svg" style="display: none">
      <symbol viewBox="0 0 100 100" id="delete-svg">
        <path
          d="M 95.664918,13.635782 C 98.460227,10.752089 98.014956,6.4689567 94.650692,4.0729473 91.286428,1.6769369 86.28951,2.0586028 83.494202,4.9422952 L 49.999999,39.398187 16.505794,4.9422952 C 13.710488,2.0586028 8.713569,1.6769369 5.3493062,4.0729473 1.9850435,6.4689567 1.5397734,10.752089 4.3350801,13.635782 L 39.684575,50 4.3350801,86.364219 c -2.7953067,2.883692 -2.3500366,7.166829 1.0142261,9.562835 3.3642628,2.39601 8.3611818,2.01434 11.1564878,-0.869346 L 49.999999,60.601813 83.494202,95.057708 c 2.795308,2.883686 7.792226,3.265356 11.15649,0.869346 3.364264,-2.396006 3.809535,-6.679143 1.014226,-9.562835 L 60.315422,50 Z"
          id="path1"
          style="stroke-width: 0.229023"
        />
      </symbol>
    </svg>
    <header>
      <h1 class="login-title">Login</h1>
          <div class="loginsignup-fields">
          <!-- <form class="loginsignup-fields"> -->
            <input
              name="email"
              type="email"
              placeholder="Email Address"
              id="email-input"
            />
            <input
              name="password"
              type="password"
              placeholder="Password"
              id="password-input"
            />
          <!-- </form> -->
        </div>
        <button class="continue-button">Continue</button>
      <div class="navbar">
        <a href="../index.html" target="_blank"
          ><img src="../imgs/tamar-logo.png" alt="" class="nav-logo"
        /></a>

        <h1 class="dashboard-title">Admin Dashboard</h1>
        <img alt="" class="nav-Profile" />
      </div>
    </header>
    <main id="main-container">
      <aside class="sidebar">
        <div>
          <div class="sidebar_add-products">
            <img src="../imgs/svgs/upload.svg" class="plus-icon" alt="" />
            <p>Add Product</p>
          </div>
          <div class="sidebar_products-list">
            <img src="../imgs/svgs/bars-solid.svg" class="list-icon" alt="" />
            <p>Products List</p>
          </div>
        </div>
      </aside>
      <section class="page-content"></section>
    </main>
  
    <!-- Fix for mobile menu categories dropdown that also respects desktop view --><script>
      document.addEventListener("DOMContentLoaded", function () {
        // Add custom CSS to fix desktop menu alignment and hover
        const styleElement = document.createElement("style");
        document.head.appendChild(styleElement);
        styleElement.textContent = `
        @media (min-width: 700px) {
          /* Fix desktop alignment */
          .menu {
            display: flex;
            align-items: center;
          }
          .menu .categories-tab {
            display: flex;
            align-items: center;
            height: 100%;
            position: relative;
          }
          .menu .categories-tab > a {
            display: flex;
            align-items: center;
            height: 100%;
            vertical-align: middle;
          }
          
          /* Fix hover behavior by applying !important to override any other rules */
          .categories-tab:hover .categories-list {
            display: block !important;
            visibility: visible !important;
            opacity: 1 !important;
            position: absolute !important;
            top: 100% !important;
            left: 0 !important;
            transform: translateY(0) !important;
            transition-delay: 0s !important;
            z-index: 2000 !important;
            min-width: 180px !important;
            background-color: #fff !important;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1) !important;
          }
          
          /* Style for category items */
          .categories-tab:hover .categories-list .category-item {
            display: block !important;
            width: 100% !important;
          }
          
          .categories-tab:hover .categories-list .category-item a {
            padding: 0.8rem 1.5rem !important;
            font-size: 0.9rem !important;
            display: block !important;
            width: 100% !important;
            color: #343a40 !important;
            background-color: #fff !important;
            text-decoration: none !important;
            border: none !important;
          }
          
          .categories-tab:hover .categories-list .category-item a:hover {
            background-color: #f8f9fa !important;
          }
        }
      `;

        // Wait for the menu to be fully loaded
        setTimeout(function () {
          // Add a click listener to the menu
          const menu = document.querySelector(".menu");
          if (menu) {
            menu.addEventListener("click", handleMenuClick);

            // Add hover functionality for desktop
            setupDesktopHoverBehavior();

            console.log("Mobile menu fix: Added menu click handler");
          }

          // Function to restore desktop hover behavior
          function setupDesktopHoverBehavior() {
            const isDesktop = window.matchMedia("(min-width: 700px)").matches;
            if (!isDesktop) return;

            // Find all category tabs
            const categoryTabs = document.querySelectorAll(".categories-tab");
            categoryTabs.forEach((tab) => {
              // Force the categories list to have correct desktop styles
              const categoriesList = tab.querySelector(".categories-list");
              if (categoriesList) {
                // Force absolute position and other essential styles for desktop
                categoriesList.style.position = "absolute";
                categoriesList.style.top = "100%";
                categoriesList.style.left = "0";
                categoriesList.style.zIndex = "2000";

                tab.addEventListener("mouseenter", function () {
                  if (window.matchMedia("(min-width: 700px)").matches) {
                    categoriesList.style.display = "block";
                    categoriesList.style.visibility = "visible";
                    categoriesList.style.opacity = "1";
                    categoriesList.style.transform = "translateY(0)";
                  }
                });

                tab.addEventListener("mouseleave", function () {
                  if (window.matchMedia("(min-width: 700px)").matches) {
                    categoriesList.style.display = "";
                    categoriesList.style.visibility = "";
                    categoriesList.style.opacity = "";
                    categoriesList.style.transform = "";
                  }
                });
              }
            });
          }

          // Function to handle menu clicks
          function handleMenuClick(event) {
            // Check if we clicked on the Shop link
            if (
              event.target.tagName === "A" &&
              (event.target.textContent.includes("Shop") ||
                event.target.textContent.includes("חנות"))
            ) {
              // Only prevent default in mobile view to allow normal desktop behavior
              const isMobile = window.matchMedia(
                "(max-width: 699.99px)"
              ).matches;
              if (isMobile) {
                event.preventDefault();
              } else {
                return; // Exit early for desktop - don't interfere with desktop behavior
              }

              console.log("Mobile menu fix: Shop link clicked");

              // Get the categories tab
              const categoriesTab = event.target.closest(".categories-tab");
              if (!categoriesTab) return;

              // Toggle active state
              const isActive = categoriesTab.classList.contains("active");

              // First clean up any existing dropdown or residual items
              cleanupAllDropdowns();

              // Toggle the active class
              if (isActive) {
                categoriesTab.classList.remove("active");
                return;
              }

              // Add active class
              categoriesTab.classList.add("active");

              // Get the categories list
              const originalList =
                categoriesTab.querySelector(".categories-list");
              if (!originalList) return;

              // Create container
              const container = document.createElement("div");
              container.className = "mobile-dropdown-fix";
              container.setAttribute("data-mobile-dropdown", "true");
              container.style.cssText = `
              width: 100%;
              background-color: #f8f9fa;
              display: block;
              position: static;
              z-index: 5;
            `;

              // Clone the list
              const listClone = originalList.cloneNode(true);
              listClone.style.cssText = `
              display: block !important;
              position: static !important;
              width: 100% !important;
              max-height: 500px !important;
              visibility: visible !important;
              opacity: 1 !important;
              padding: 0 !important;
              margin: 0 !important;
              background-color: #f8f9fa !important;
            `;

              // Remove any duplicate Shalom Club items (if they exist)
              const shalomClubItems = listClone.querySelectorAll(
                ".category-item--shalom-club"
              );
              if (shalomClubItems.length > 1) {
                for (let i = 1; i < shalomClubItems.length; i++) {
                  if (shalomClubItems[i].parentNode) {
                    shalomClubItems[i].parentNode.removeChild(
                      shalomClubItems[i]
                    );
                  }
                }
              }

              // Style list items
              const items = listClone.querySelectorAll(".category-item");
              items.forEach((item) => {
                item.style.cssText = `
                display: block !important;
                width: 100% !important;
              `;

                const link = item.querySelector("a");
                if (link) {
                  if (link.classList.contains("attrib-heb")) {
                    link.style.paddingRight = "2.5rem";
                  } else {
                    link.style.paddingLeft = "2.5rem";
                  }
                }
              });

              // Add to container and insert
              container.appendChild(listClone);
              const nextSibling = categoriesTab.nextElementSibling;
              if (nextSibling) {
                categoriesTab.parentNode.insertBefore(container, nextSibling);
              } else {
                categoriesTab.parentNode.appendChild(container);
              }
            }
          }

          // Helper function to clean up all dropdowns and stray elements
          function cleanupAllDropdowns() {
            // Only run cleanup if we're in mobile view
            const isMobile = window.matchMedia("(max-width: 699.99px)").matches;
            if (!isMobile) return;

            // Remove mobile dropdown containers
            const dropdownContainers = document.querySelectorAll(
              '.mobile-dropdown-fix, [data-mobile-dropdown="true"]'
            );
            dropdownContainers.forEach((container) => {
              if (container && container.parentNode) {
                container.parentNode.removeChild(container);
              }
            });

            // Remove any active classes from mobile elements
            const activeTabs = document.querySelectorAll(
              ".menu .categories-tab.active"
            );
            activeTabs.forEach((tab) => {
              // Only clean up tabs in mobile menu
              if (
                window.getComputedStyle(tab.closest(".menu")).flexDirection ===
                "column"
              ) {
                tab.classList.remove("active");
              }
            });

            // Fix any stray visible categories by hiding all categories lists in mobile view
            const allCategoriesLists =
              document.querySelectorAll(".categories-list");
            allCategoriesLists.forEach((list) => {
              // Only affect mobile view categories
              if (
                window.getComputedStyle(list.closest(".menu") || document.body)
                  .flexDirection === "column"
              ) {
                list.classList.remove("categories-list--active");
                list.style.display = "none";
              }
            });

            // Fix any stray category item that might still be visible in mobile view
            const allCategoryItems =
              document.querySelectorAll(".category-item");
            allCategoryItems.forEach((item) => {
              const menuParent = item.closest(".menu");
              if (
                menuParent &&
                window.getComputedStyle(menuParent).flexDirection === "column"
              ) {
                if (
                  !item.closest(".categories-list") ||
                  !item
                    .closest(".categories-list")
                    .classList.contains("categories-list--active")
                ) {
                  item.style.display = "none";
                }
              }
            });
          }

          // Fix desktop styles on load and resize
          function fixDesktopStyles() {
            const isDesktop = window.matchMedia("(min-width: 700px)").matches;
            if (isDesktop) {
              // Find and fix Shop tab alignment in desktop
              const shopTabs = document.querySelectorAll(".categories-tab");
              shopTabs.forEach((tab) => {
                // Clear any problematic styles
                tab.style.removeProperty("display");
                tab.style.removeProperty("position");
                tab.style.removeProperty("width");

                // Ensure proper alignment with siblings
                tab.style.alignSelf = "center";
                tab.style.height = "100%";

                // Fix the Shop link alignment
                const shopLink = tab.querySelector("a");
                if (shopLink) {
                  shopLink.style.display = "flex";
                  shopLink.style.alignItems = "center";
                  shopLink.style.height = "100%";
                  shopLink.style.verticalAlign = "middle";
                }

                // Make sure categories list has correct desktop styles
                const categoriesList = tab.querySelector(".categories-list");
                if (categoriesList) {
                  categoriesList.style.removeProperty("display");
                  categoriesList.style.removeProperty("visibility");
                  categoriesList.style.removeProperty("opacity");
                  categoriesList.style.position = "absolute";
                  categoriesList.style.top = "100%";
                  categoriesList.style.left = "0";
                  categoriesList.style.zIndex = "2000";
                }
              });

              // Re-setup hover behavior
              setupDesktopHoverBehavior();
            }
          }

          // Clean up on page load to ensure a clean state
          setTimeout(() => {
            cleanupAllDropdowns();
            fixDesktopStyles();
          }, 100);

          // Add event listener to body to close dropdown when clicking outside
          document.body.addEventListener("click", function (e) {
            // If the click is outside any categories tab or dropdown
            if (
              !e.target.closest(".categories-tab") &&
              !e.target.closest(".mobile-dropdown-fix")
            ) {
              cleanupAllDropdowns();
            }
          });

          // Check for window resize and clean up if needed
          window.addEventListener("resize", function () {
            cleanupAllDropdowns();
            fixDesktopStyles();
          });
        }, 500); // Half-second delay to ensure everything is loaded
      });
    </script>

    <script src="../js/menu-consolidated.js"></script>
</body>
</html>
