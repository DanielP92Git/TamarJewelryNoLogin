---
phase: 09-testing-polish
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - .planning/phases/09-testing-polish/09-TEST-RESULTS.md
  - .planning/phases/09-testing-polish/09-BUGS.md
autonomous: true

must_haves:
  truths:
    - "Keyboard accessibility test results documented for modal and reordering"
    - "Memory leak baseline established (before/after 20 navigations)"
    - "Concurrent admin test demonstrates 409 conflict handling"
  artifacts:
    - path: ".planning/phases/09-testing-polish/09-TEST-RESULTS.md"
      provides: "Structured test results for desktop testing"
      contains: "## Desktop Testing Results"
    - path: ".planning/phases/09-testing-polish/09-BUGS.md"
      provides: "Bug catalog for batch fixing"
      contains: "## Bug Catalog"
  key_links:
    - from: "Test scenarios"
      to: "Success Criteria 3, 4, 6"
      via: "Documented results"
      pattern: "keyboard|memory|concurrent"
---

<objective>
Execute desktop browser testing for Phase 9 Success Criteria #3 (concurrent admin), #4 (memory leaks), and #6 (keyboard accessibility).

Purpose: Validate core desktop functionality before touch device and RTL testing. Desktop tests can be executed autonomously using Chrome DevTools and multiple browser windows.

Output: 09-TEST-RESULTS.md with structured test results, 09-BUGS.md with any issues found
</objective>

<execution_context>
@C:\Users\pagis\.claude/get-shit-done/workflows/execute-plan.md
@C:\Users\pagis\.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/09-testing-polish/09-CONTEXT.md
@.planning/phases/09-testing-polish/09-RESEARCH.md
@.planning/phases/06-frontend-product-reordering/06-04-SUMMARY.md
@.planning/phases/08-modal-integration-image-reordering/08-05-SUMMARY.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Keyboard Accessibility Testing</name>
  <files>.planning/phases/09-testing-polish/09-TEST-RESULTS.md, .planning/phases/09-testing-polish/09-BUGS.md</files>
  <action>
Execute keyboard accessibility tests in Chrome desktop. Create 09-TEST-RESULTS.md and 09-BUGS.md files.

**Test Scenarios (Success Criterion #6):**

1. **Modal Keyboard Navigation:**
   - Tab to product row, press Enter to open modal
   - Verify focus moves to first button inside modal
   - Tab through all modal buttons (Edit, Delete, Duplicate, Close)
   - Verify focus cycles (Tab from last element returns to first)
   - Shift+Tab reverses direction
   - Press Esc to close modal
   - Verify focus returns to triggering product row

2. **Product Reordering Keyboard Access:**
   - Tab to drag handle in reorder mode
   - Attempt keyboard drag (Space/Enter to grab, Arrow keys to move, Space/Enter to drop)
   - NOTE: SortableJS does NOT support keyboard drag by default - this test will likely FAIL
   - Document whether alternative exists (move up/down buttons) or if this is a gap

3. **Undo/Redo Keyboard Shortcuts:**
   - Enter reorder mode, drag a product
   - Press Ctrl+Z (should undo)
   - Press Ctrl+Y (should redo)
   - Press Escape (should prompt cancel if unsaved)

4. **Focus Indicators:**
   - Verify visible focus outline on all focusable elements
   - Check :focus-visible behavior (outline on Tab, not on click)

**Document Results:**
- Create 09-TEST-RESULTS.md with structured format from RESEARCH.md
- For each test: Status (PASS/FAIL/PARTIAL), Notes, Bug ID if applicable
- Create 09-BUGS.md with bug catalog structure

**Expected Outcome:**
- Modal keyboard navigation: Should PASS (focus trap implemented in 08-05)
- Product reordering keyboard: Expected FAIL (SortableJS limitation)
- Undo/redo shortcuts: Should PASS (implemented in Phase 6)
- Focus indicators: Should PASS (implemented across phases)
  </action>
  <verify>
- 09-TEST-RESULTS.md exists with "## Keyboard Accessibility Tests" section
- 09-BUGS.md exists with bug catalog structure
- Each test scenario has documented result (PASS/FAIL/PARTIAL)
- Any FAIL has corresponding bug entry in 09-BUGS.md
  </verify>
  <done>
Keyboard accessibility tests complete with documented results. Keyboard reordering gap documented if confirmed.
  </done>
</task>

<task type="auto">
  <name>Task 2: Memory Leak Baseline Testing</name>
  <files>.planning/phases/09-testing-polish/09-TEST-RESULTS.md</files>
  <action>
Execute memory leak baseline testing using Chrome DevTools Performance Monitor.

**Test Scenario (Success Criterion #4):**

1. **Setup:**
   - Open Chrome DevTools > Performance Monitor (Ctrl+Shift+P > "Show Performance monitor")
   - Navigate to Admin Products page
   - Record baseline metrics:
     - JS Heap Size
     - DOM Nodes count
     - Event Listeners count

2. **Test: 20 Page Navigations:**
   - Navigate between Admin Products pages (Bracelets > Necklaces > Rings > repeat)
   - After 20 navigations, record metrics
   - Calculate growth percentages

3. **Test: Modal Open/Close Cycles:**
   - Open product preview modal 10 times (click row > Esc to close)
   - Record metrics
   - Check for detached DOM nodes

4. **Test: Reorder Mode Enter/Exit:**
   - Enter reorder mode, drag a product, cancel (5 cycles)
   - Record metrics
   - Check for orphaned SortableJS instances

**Passing Criteria (from CONTEXT.md - "quick sanity check"):**
- No heap growth > 20% after GC
- No detached DOM nodes accumulating
- No event listener count steadily increasing

**Document in 09-TEST-RESULTS.md:**
- Before/after metrics table
- Growth percentages
- PASS/FAIL assessment
- Any concerning patterns noted
  </action>
  <verify>
- 09-TEST-RESULTS.md contains "## Memory Leak Testing" section
- Baseline and post-test metrics documented
- Growth percentages calculated
- PASS/FAIL determination made
  </verify>
  <done>
Memory leak baseline testing complete. No significant leaks detected, or leak bugs documented in 09-BUGS.md.
  </done>
</task>

<task type="auto">
  <name>Task 3: Concurrent Admin Testing</name>
  <files>.planning/phases/09-testing-polish/09-TEST-RESULTS.md</files>
  <action>
Execute concurrent admin testing using two browser windows/profiles.

**Test Scenario (Success Criterion #3):**

1. **Setup:**
   - Open two browser windows (or Chrome profiles to avoid session sharing)
   - Both login as admin (same or different accounts)
   - Both navigate to same category (e.g., Bracelets)
   - Both enter reorder mode

2. **Concurrent Save Test:**
   - Admin A: Drag Product 1 from position 1 to position 3
   - Admin B: Drag Product 2 from position 2 to position 5
   - Admin A: Click "Save Order" (should succeed)
   - Wait for success toast in Admin A
   - Admin B: Click "Save Order" (should get 409 Conflict)

3. **Verify 409 Handling:**
   - Admin B sees toast: "Product list was updated by another admin. Refreshing..." (or similar)
   - Admin B's list auto-refreshes with Admin A's changes
   - Admin B can re-apply their changes and save again

4. **Database Integrity Check:**
   - Query MongoDB to verify no data corruption:
     - All products present (none lost)
     - No duplicate displayOrder values
     - Order matches last successful save

**Document in 09-TEST-RESULTS.md:**
- Step-by-step results
- Screenshots if needed (describe what was seen)
- PASS/FAIL for each verification point
- Database state verification
  </action>
  <verify>
- 09-TEST-RESULTS.md contains "## Concurrent Admin Testing" section
- 409 Conflict handling documented
- Database integrity verified
- PASS/FAIL determination made
  </verify>
  <done>
Concurrent admin testing complete. Optimistic locking works correctly, or race condition bugs documented.
  </done>
</task>

</tasks>

<verification>
After all tasks complete:
1. 09-TEST-RESULTS.md exists with all three test sections
2. 09-BUGS.md exists (may be empty if no bugs found)
3. All tests have documented PASS/FAIL status
4. Any blocking issues identified for v1.1 ship decision
</verification>

<success_criteria>
- Keyboard accessibility documented (modal PASS, reordering gap documented)
- Memory leak baseline established (PASS with <20% growth or bugs documented)
- Concurrent admin 409 handling verified (PASS or bugs documented)
- Bug catalog created for any issues found
</success_criteria>

<output>
After completion, create `.planning/phases/09-testing-polish/09-01-SUMMARY.md`
</output>
