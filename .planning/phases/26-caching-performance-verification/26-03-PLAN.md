---
phase: 26-caching-performance-verification
plan: 03
type: execute
wave: 1
depends_on: []
files_modified:
  - frontend/css/desktop-menu.css
  - backend/views/partials/meta-tags.ejs
autonomous: true

must_haves:
  truths:
    - "All Google Fonts references include display=swap to prevent render-blocking text"
    - "Google Search Console meta tag verification is embedded in the HTML head of all SSR pages"
  artifacts:
    - path: "frontend/css/desktop-menu.css"
      provides: "Google Fonts @import with display=swap parameter"
      contains: "display=swap"
    - path: "backend/views/partials/meta-tags.ejs"
      provides: "Google Site Verification meta tag placeholder"
      contains: "google-site-verification"
  key_links:
    - from: "backend/views/partials/meta-tags.ejs"
      to: "all SSR pages"
      via: "EJS include partial"
      pattern: "include.*meta-tags"
---

<objective>
Ensure Google Fonts do not block rendering by verifying display=swap on all font references, and add Google Search Console meta tag verification to the shared meta-tags partial.

Purpose: Prevent Flash of Invisible Text (FOIT) on font loading, and prepare for Google Search Console verification so the sitemap can be submitted.
Output: All font references verified/fixed, meta tag placeholder ready for Search Console verification code.
</objective>

<execution_context>
@C:/Users/pagis/.claude/get-shit-done/workflows/execute-plan.md
@C:/Users/pagis/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@frontend/css/desktop-menu.css
@backend/views/partials/meta-tags.ejs
</context>

<tasks>

<task type="auto">
  <name>Task 1: Verify Google Fonts display=swap and add Search Console meta tag</name>
  <files>frontend/css/desktop-menu.css, backend/views/partials/meta-tags.ejs</files>
  <action>
1. **Verify Google Fonts display=swap across all files:**
   - Search all frontend CSS files and EJS templates for Google Fonts references:
     ```bash
     grep -rn "fonts.googleapis" frontend/ backend/views/
     ```
   - For each reference found, verify it includes `display=swap` in the URL query parameter
   - The research identified `frontend/css/desktop-menu.css` line 1 has an `@import url(...)` â€” verify it already has `display=swap`. Based on the codebase scan, it already does: `@import url('https://fonts.googleapis.com/css2?family=Great+Vibes&family=Montserrat:wght@300;400;500;600&display=swap');`
   - If any reference is missing `display=swap`, add it to the URL query string (append `&display=swap` before the closing quote)
   - NOTE: The `@import` in CSS is slightly less performant than `<link>` in HTML, but changing it now could break the cascade order. Leave as `@import` but ensure `display=swap` is present. The performance impact is minimal since this CSS is only loaded on desktop (800px+ screens).

2. **Add Google Search Console verification meta tag to meta-tags.ejs:**
   - Open `backend/views/partials/meta-tags.ejs`
   - Add a Google Site Verification meta tag. Since the actual verification code is obtained from Google Search Console during setup (which requires the user), add it as an environment variable placeholder:
     ```html
     <% if (typeof process !== 'undefined' && process.env.GOOGLE_SITE_VERIFICATION) { %>
     <meta name="google-site-verification" content="<%= process.env.GOOGLE_SITE_VERIFICATION %>" />
     <% } %>
     ```
   - Place this tag near the other meta tags (after the description meta, before OG tags)
   - This approach: no tag rendered if env var not set (development), renders verification code in production when configured

3. **Verify no other font references exist without display=swap:**
   - Also check EJS template files for inline `<link>` tags loading Google Fonts
   - Check `backend/views/layouts/` and `backend/views/partials/` for any additional font references
  </action>
  <verify>
  - `grep -rn "fonts.googleapis" frontend/ backend/views/ | grep -v "display=swap"` returns empty (all font refs have display=swap)
  - `grep "google-site-verification" backend/views/partials/meta-tags.ejs` shows the meta tag
  - `grep "GOOGLE_SITE_VERIFICATION" backend/views/partials/meta-tags.ejs` shows the env var reference
  </verify>
  <done>All Google Fonts references include display=swap, Google Search Console meta tag is conditionally rendered from GOOGLE_SITE_VERIFICATION environment variable in the shared meta-tags partial that all SSR pages include</done>
</task>

</tasks>

<verification>
- No Google Fonts reference anywhere in the codebase lacks display=swap
- meta-tags.ejs includes conditional google-site-verification meta tag
- The verification meta tag only renders when GOOGLE_SITE_VERIFICATION env var is set
</verification>

<success_criteria>
Google Fonts render with swap behavior (no FOIT), and the application is ready for Google Search Console verification by setting a single environment variable.
</success_criteria>

<output>
After completion, create `.planning/phases/26-caching-performance-verification/26-03-SUMMARY.md`
</output>
