---
phase: 04-schema-foundation-library-setup
plan: 02
type: execute
wave: 1
depends_on: []
files_modified:
  - frontend/package.json
  - frontend/css/variables.css
autonomous: true

must_haves:
  truths:
    - "SortableJS library is installed and available for import"
    - "Z-index CSS variables are defined for modal and drag layers"
    - "CSS variable scale follows Bootstrap-compatible conventions"
  artifacts:
    - path: "frontend/package.json"
      provides: "SortableJS dependency"
      contains: "sortablejs"
    - path: "frontend/css/variables.css"
      provides: "Z-index CSS custom properties"
      contains: "--z-modal"
  key_links:
    - from: "frontend/css/variables.css"
      to: "Admin styles (future Phase 6/8)"
      via: "CSS custom property inheritance"
      pattern: "var\\(--z-"
---

<objective>
Install SortableJS library for future drag-and-drop functionality and establish z-index CSS variable system for modal/drag layer management.

Purpose: Prepare frontend infrastructure for Phase 6 (product reordering) and Phase 8 (modal integration) without implementing any UI yet.
Output: SortableJS installed as dependency, CSS variables file created with z-index scale.
</objective>

<execution_context>
@C:\Users\pagis\.claude/get-shit-done/workflows/execute-plan.md
@C:\Users\pagis\.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/04-schema-foundation-library-setup/04-CONTEXT.md
@.planning/phases/04-schema-foundation-library-setup/04-RESEARCH.md
@frontend/package.json
</context>

<tasks>

<task type="auto">
  <name>Task 1: Install SortableJS library</name>
  <files>frontend/package.json</files>
  <action>
Install SortableJS as a runtime dependency (not dev dependency - needed in production):

```bash
cd frontend && npm install sortablejs --save
```

SortableJS is framework-agnostic and works with the existing vanilla JS MVC architecture. It will be imported in Phase 6 when implementing drag-and-drop product reordering.

Why SortableJS (per RESEARCH.md):
- 27k+ GitHub stars, industry standard (Trello, GitHub Projects, Shopify admin)
- Zero dependencies, works with vanilla JavaScript
- Touch support for mobile/tablet
- RTL awareness for future Hebrew admin (if needed)
- Keyboard navigation support for accessibility

Version note: Install latest stable (1.15+). Do not pin to specific version unless there's a breaking change concern.
  </action>
  <verify>
- Check frontend/package.json includes "sortablejs" in dependencies (not devDependencies)
- Run `cd frontend && npm ls sortablejs` to verify installation
  </verify>
  <done>
- sortablejs listed in frontend/package.json dependencies section
- npm install completes without errors
  </done>
</task>

<task type="auto">
  <name>Task 2: Create z-index CSS variable system</name>
  <files>frontend/css/variables.css</files>
  <action>
Create a new CSS file `frontend/css/variables.css` that establishes a z-index scale for consistent layering across the application.

This file will be the central source of truth for z-index values, preventing ad-hoc values scattered across CSS files.

**Create frontend/css/variables.css:**

```css
/**
 * CSS Custom Properties (Variables)
 *
 * Z-Index Scale:
 * - Uses gaps of 50-100 to allow intermediate layers without renumbering
 * - Bootstrap-compatible values (modal-backdrop: 1050, modal: 1055)
 * - Drag elements above modals for clear UX during drag operations
 *
 * Usage: z-index: var(--z-modal);
 */

:root {
  /* ============================================
   * Z-Index Scale
   * ============================================ */

  /* Base layers */
  --z-base: 0;
  --z-dropdown: 200;
  --z-sticky: 300;
  --z-header: 100;

  /* Modal layers (Phase 8 - product preview modal) */
  --z-modal-backdrop: 1050;
  --z-modal: 1055;
  --z-modal-close: 1060;

  /* Drag-and-drop layers (Phase 6 - product reordering) */
  --z-sortable-ghost: 1100;      /* Dragging element preview */
  --z-sortable-chosen: 1105;     /* Selected element during drag */
  --z-sortable-drag: 1110;       /* Active drag element */

  /* Toast notifications / alerts (highest priority) */
  --z-toast: 2000;
  --z-tooltip: 2100;
}

/* ============================================
 * SortableJS Integration Classes (Phase 6)
 *
 * These classes are applied automatically by SortableJS
 * during drag operations. Styling here ensures proper
 * z-index layering.
 * ============================================ */

.sortable-ghost {
  z-index: var(--z-sortable-ghost);
  opacity: 0.4;
  background-color: #f0f0f0;
}

.sortable-chosen {
  z-index: var(--z-sortable-chosen);
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
}

.sortable-drag {
  z-index: var(--z-sortable-drag);
  opacity: 1;
}

/* Prevent transform creating stacking context issues (per RESEARCH.md pitfall #4) */
.sortable-fallback {
  z-index: var(--z-sortable-drag);
}
```

**Important notes:**
- Do NOT import this file anywhere yet - Phase 6/8 will handle integration
- The file establishes the FOUNDATION - actual usage comes in later phases
- Z-index values are Bootstrap-compatible for future library integration
- SortableJS classes (.sortable-ghost, etc.) are pre-styled but won't activate until SortableJS is instantiated

**Why these specific values (per RESEARCH.md):**
- Modal backdrop at 1050 matches Bootstrap conventions
- Drag elements (1100+) above modals so drag operations are always visible
- Gaps of 50 allow inserting intermediate layers without redefining scale
  </action>
  <verify>
- frontend/css/variables.css file exists
- File contains :root with --z-modal and --z-sortable-ghost variables
- File has comments explaining the scale and usage
- CSS syntax is valid (no parse errors)
  </verify>
  <done>
- variables.css created with z-index CSS custom properties
- Scale includes base, modal, drag, and toast layers
- SortableJS classes pre-styled with correct z-index variables
- File is standalone (not imported anywhere yet - deferred to Phase 6)
  </done>
</task>

</tasks>

<verification>
After all tasks complete:

1. **SortableJS installed:**
   ```bash
   cd frontend && npm ls sortablejs
   ```
   Should show sortablejs@X.X.X in dependency tree

2. **CSS variables file exists:**
   - frontend/css/variables.css exists
   - Contains --z-modal-backdrop, --z-modal, --z-sortable-ghost variables
   - Contains .sortable-ghost, .sortable-chosen, .sortable-drag class definitions

3. **No broken imports:**
   - variables.css is NOT imported anywhere yet (intentional)
   - Frontend dev server should still work: `cd frontend && npm run dev`
   - Page loads without CSS errors

NOTE: This plan only INSTALLS the library and CREATES the CSS foundation.
Actual drag-and-drop implementation happens in Phase 6.
CSS import into admin pages happens in Phase 6/8.
</verification>

<success_criteria>
- [ ] sortablejs installed in frontend/package.json dependencies
- [ ] npm ls sortablejs shows library installed
- [ ] frontend/css/variables.css created
- [ ] CSS file defines z-index variables (--z-modal, --z-sortable-ghost, etc.)
- [ ] CSS file includes SortableJS class styling (.sortable-ghost, etc.)
- [ ] Frontend still builds/runs without errors
</success_criteria>

<output>
After completion, create `.planning/phases/04-schema-foundation-library-setup/04-02-SUMMARY.md`
</output>
