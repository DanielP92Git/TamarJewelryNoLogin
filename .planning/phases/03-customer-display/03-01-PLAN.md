---
phase: 03-customer-display
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - frontend/js/Views/categoriesView.js
  - frontend/css/categories-800plus.css
  - frontend/css/categories-devices.css
autonomous: false

must_haves:
  truths:
    - "Customer sees SKU on product modal when SKU exists"
    - "Customer sees placeholder text when product has no SKU"
    - "SKU label displays in correct language (SKU: or makat)"
    - "SKU value never reverses in Hebrew/RTL mode"
    - "Customer can click SKU to copy to clipboard"
    - "Copied! tooltip appears briefly after copy"
  artifacts:
    - path: "frontend/js/Views/categoriesView.js"
      provides: "SKU markup generation and copy handler"
      contains: "_generateSkuMarkup"
    - path: "frontend/css/categories-800plus.css"
      provides: "Desktop SKU styling"
      contains: ".product-sku"
    - path: "frontend/css/categories-devices.css"
      provides: "Mobile SKU styling"
      contains: ".product-sku"
  key_links:
    - from: "generatePreview()"
      to: "_generateSkuMarkup()"
      via: "method call with product.sku"
      pattern: "_generateSkuMarkup\\(.*sku"
    - from: "_setupModalEventListeners()"
      to: "navigator.clipboard.writeText"
      via: "click handler on .product-sku"
      pattern: "navigator\\.clipboard\\.writeText"
---

<objective>
Display SKU information on product modal for customers with multi-language support, RTL handling, and copy-to-clipboard functionality.

Purpose: Complete the SKU management feature by exposing SKU data to customers in a professional, accessible format that follows e-commerce conventions.

Output: Modified categoriesView.js with SKU display logic and copy handler; CSS files with SKU styling for desktop and mobile.
</objective>

<execution_context>
@C:\Users\pagis\.claude/get-shit-done/workflows/execute-plan.md
@C:\Users\pagis\.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/03-customer-display/03-CONTEXT.md
@.planning/phases/03-customer-display/03-RESEARCH.md
@frontend/js/Views/categoriesView.js
@frontend/css/categories-800plus.css
@frontend/css/categories-devices.css
</context>

<tasks>

<task type="auto">
  <name>Task 1: Add SKU display to product modal</name>
  <files>frontend/js/Views/categoriesView.js</files>
  <action>
    Modify categoriesView.js to display SKU in product modal:

    1. Add `_generateSkuMarkup(sku)` helper method that:
       - Takes `sku` parameter (string or null)
       - Returns HTML markup with conditional styling
       - For valid SKU: `<div class="product-sku" data-sku="${sku}" tabindex="0">` with label and value spans
       - For missing SKU: `<div class="product-sku product-sku--placeholder">` with "Not available" / "la zmin" placeholder
       - Label uses `this.lang === 'eng' ? 'SKU:' : 'makat:'` (Hebrew: makat = mem-kuf-tet-apostrophe)
       - Value span always has `dir="ltr"` attribute to prevent reversal in RTL mode
       - Include `tabindex="0"` on clickable SKU elements for keyboard accessibility

    2. Modify `generatePreview()` method (around line 604-898):
       - After getting `product` from `this.products.find()` (line 611), extract SKU: `const sku = product?.sku || null;`
       - Call `const skuMarkup = this._generateSkuMarkup(sku);`
       - Insert `${skuMarkup}` inside the `.details-container` div, AFTER the `.item-description_modal` div (around line 853)
       - For empty description case, insert SKU inside the empty `.details-container` div

    3. Add click-to-copy handler in `_setupModalEventListeners()` method (around line 1360):
       - Add event listener for click on `.product-sku:not(.product-sku--placeholder)`
       - Extract SKU from `element.dataset.sku`
       - Check `navigator.clipboard` exists before attempting copy
       - Use `await navigator.clipboard.writeText(skuValue)`
       - On success: add `data-tooltip` attribute with "Copied!" / "he'otek!" (Hebrew) and add `copied` class
       - Remove class and attribute after 2000ms with setTimeout
       - Wrap in try/catch, log errors to console

    4. Add keyboard handler for accessibility:
       - On Enter or Space keypress on `.product-sku:not(.product-sku--placeholder)`, trigger same copy logic
       - Use `e.key === 'Enter' || e.key === ' '`
  </action>
  <verify>
    - Open browser dev tools, navigate to product page
    - Click a product to open modal
    - Verify SKU appears below description with correct label
    - Verify clicking SKU copies to clipboard (paste elsewhere to confirm)
    - Verify "Copied!" tooltip appears
    - Switch to Hebrew, verify label changes to makat
    - Check console for no errors
  </verify>
  <done>
    SKU displays in modal with correct language label, copy-to-clipboard works, no console errors
  </done>
</task>

<task type="auto">
  <name>Task 2: Add SKU CSS styling</name>
  <files>frontend/css/categories-800plus.css, frontend/css/categories-devices.css</files>
  <action>
    Add CSS for SKU display in both CSS files:

    1. In categories-800plus.css (desktop), add after `.details-container` styles (around line 573):
       ```css
       /* SKU Display */
       .product-sku {
         display: flex;
         align-items: center;
         gap: 8px;
         padding: 8px 12px;
         margin-top: 12px;
         background-color: #f5f5f5;
         border-radius: 6px;
         font-size: 0.85rem;
         transition: background-color 0.2s ease;
         position: relative;
       }

       .product-sku:not(.product-sku--placeholder) {
         cursor: pointer;
       }

       .product-sku:not(.product-sku--placeholder):hover {
         background-color: #ebebeb;
       }

       .product-sku:not(.product-sku--placeholder):focus {
         outline: 2px solid #4a90e2;
         outline-offset: 2px;
       }

       .sku-label {
         font-weight: 600;
         color: #333;
       }

       .sku-value {
         color: #666;
         font-family: 'Courier New', monospace;
         direction: ltr;
         unicode-bidi: plaintext;
         display: inline-block;
       }

       /* Placeholder styling */
       .product-sku--placeholder {
         opacity: 0.6;
         cursor: default;
       }

       .product-sku--placeholder .sku-value {
         font-style: italic;
         font-family: inherit;
       }

       /* RTL alignment */
       .item-specs[dir='rtl'] .product-sku {
         flex-direction: row;
         text-align: right;
       }

       .item-specs[dir='ltr'] .product-sku {
         flex-direction: row;
         text-align: left;
       }

       /* Tooltip for copied feedback */
       .product-sku.copied::after {
         content: attr(data-tooltip);
         position: absolute;
         top: calc(100% + 8px);
         left: 50%;
         transform: translateX(-50%);
         background-color: #1f2937;
         color: white;
         padding: 6px 12px;
         border-radius: 4px;
         font-size: 0.85rem;
         white-space: nowrap;
         pointer-events: none;
         animation: tooltip-fade-in-out 2s ease-in-out;
         z-index: 10;
       }

       @keyframes tooltip-fade-in-out {
         0% { opacity: 0; transform: translateX(-50%) translateY(-5px); }
         15% { opacity: 1; transform: translateX(-50%) translateY(0); }
         85% { opacity: 1; transform: translateX(-50%) translateY(0); }
         100% { opacity: 0; transform: translateX(-50%) translateY(-5px); }
       }
       ```

    2. In categories-devices.css (mobile), add after `.details-container` styles (around line 686):
       - Copy the same CSS rules as desktop
       - Adjust padding to `padding: 6px 10px` for tighter mobile spacing
       - Keep all other styles identical (tooltip, RTL, placeholder)
  </action>
  <verify>
    - Check desktop view: SKU has gray background, rounded corners
    - Check hover state changes background color
    - Check mobile view (resize browser or use dev tools): same styling with tighter padding
    - Switch to Hebrew: verify SKU block aligns right
    - Click SKU: verify tooltip appears below
  </verify>
  <done>
    SKU styled consistently on desktop and mobile, RTL alignment works, tooltip visible on copy
  </done>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <what-built>
    Complete SKU display on product modal:
    - SKU appears below description in product modals
    - Language-aware labels (SKU: in English, makat in Hebrew)
    - Copy-to-clipboard with "Copied!" tooltip feedback
    - Placeholder text for products without SKU
    - RTL support for Hebrew mode
    - Keyboard accessibility (Tab + Enter to copy)
  </what-built>
  <how-to-verify>
    1. Start frontend dev server: `cd frontend && npm run dev`
    2. Open browser to http://localhost:1234/bracelets.html (or any category)
    3. Click a product WITH SKU (one you added in Phase 2):
       - Verify SKU appears at bottom of description area
       - Verify label says "SKU:"
       - Click SKU - verify "Copied!" tooltip appears
       - Paste elsewhere - verify SKU value was copied
    4. Click a product WITHOUT SKU (legacy product):
       - Verify "Not available" placeholder appears
       - Verify clicking does nothing (no copy action)
    5. Switch language to Hebrew (use language selector):
       - Verify label changes to Hebrew characters
       - Verify SKU value (ABC123) does NOT reverse
       - Verify block aligns to right side
    6. Test keyboard accessibility:
       - Tab to SKU element
       - Press Enter - verify copy works
    7. Check mobile view (dev tools, responsive mode):
       - Verify styling looks correct on small screens
  </how-to-verify>
  <resume-signal>Type "approved" or describe any issues found</resume-signal>
</task>

</tasks>

<verification>
All Phase 3 requirements verified:
- DISP-01: SKU displayed on frontend product modal when exists
- DISP-02: SKU formatted as small text with proper label
- DISP-03: Products without SKUs show graceful placeholder
- DISP-04: SKU positioned at bottom of description container
- LANG-01: SKU label translated (SKU: / makat)
- LANG-02: SKU display works with RTL layout
</verification>

<success_criteria>
1. Products with SKU: Display "SKU: ABC123" (or Hebrew equivalent) below description
2. Products without SKU: Display "Not available" / Hebrew placeholder
3. Copy-to-clipboard: Clicking SKU copies value, shows tooltip
4. RTL mode: SKU value stays LTR, container aligns right
5. No console errors or broken UI
6. Works on desktop and mobile viewports
</success_criteria>

<output>
After completion, create `.planning/phases/03-customer-display/03-01-SUMMARY.md`
</output>
