---
phase: 24-static-page-ssr-meta-tags-deployment-merge
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - backend/config/meta.js
  - backend/views/partials/meta-tags.ejs
  - backend/views/partials/header.ejs
  - backend/views/partials/footer.ejs
autonomous: true

must_haves:
  truths:
    - "Every SSR page can include a single meta-tags partial that renders title, description, canonical, OG, Twitter Card, and hreflang tags"
    - "Header partial renders the full navigation structure matching the existing frontend HTML (logo, nav links, cart icon, language/currency selectors)"
    - "Footer partial renders category links, policy links, and copyright matching the existing frontend HTML"
    - "Meta config provides bilingual title and description for every static page (home, about, contact, workshop, policies)"
  artifacts:
    - path: "backend/config/meta.js"
      provides: "Bilingual meta tag configuration for all pages"
      exports: ["module.exports"]
    - path: "backend/views/partials/meta-tags.ejs"
      provides: "Centralized SEO meta tags partial"
      contains: "og:title"
    - path: "backend/views/partials/header.ejs"
      provides: "Full site header with navigation"
      contains: "site-header"
    - path: "backend/views/partials/footer.ejs"
      provides: "Full site footer with links"
      contains: "footer"
  key_links:
    - from: "backend/views/partials/meta-tags.ejs"
      to: "backend/config/meta.js"
      via: "Page routes pass meta config values as template variables"
      pattern: "title.*description.*canonical"
---

<objective>
Create the foundational meta configuration, meta-tags partial, and rebuild header/footer partials to match the existing frontend HTML structure.

Purpose: All SSR pages in Plans 02-03 depend on these shared partials and meta config. Building them first avoids duplication and ensures consistent SEO tags across every page.
Output: backend/config/meta.js, updated partials (meta-tags.ejs, header.ejs, footer.ejs)
</objective>

<execution_context>
@C:/Users/pagis/.claude/get-shit-done/workflows/execute-plan.md
@C:/Users/pagis/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/24-static-page-ssr-meta-tags-deployment-merge/24-RESEARCH.md
@.planning/phases/23-foundation-infrastructure/23-01-SUMMARY.md
@.planning/phases/23-foundation-infrastructure/23-05-SUMMARY.md
@frontend/index.html
@frontend/html/about.html
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create meta configuration and meta-tags partial</name>
  <files>backend/config/meta.js, backend/views/partials/meta-tags.ejs</files>
  <action>
Create `backend/config/meta.js` exporting an object with bilingual (eng/heb) title and description for each page: home, about, contact, workshop, policies. Each description must be 120-158 characters and keyword-optimized. Use the research file examples as starting point but verify character counts.

Create `backend/views/partials/meta-tags.ejs` that renders all SEO head tags when included. The partial receives these variables: title, description, canonical, ogImage, lang, alternateUrl (object with en and he keys), pageStyles (array of CSS objects with href and media).

The partial must output:
- `<meta charset>` and `<meta viewport>`
- `<title>` with ` | Tamar Kfir Jewelry` suffix (except home page where title IS the brand)
- `<meta name="description">`
- `<link rel="canonical">` (self-referencing, absolute URL)
- Favicon links (svg, png, apple-touch-icon) pointing to /imgs/icons/
- Google Fonts links (Raleway, Amatic SC, Poiret One, Great Vibes, Montserrat, Rubik)
- Open Graph tags: og:title, og:description, og:image, og:url, og:type (website), og:locale (en_US or he_IL)
- Twitter Card tags: twitter:card (summary_large_image), twitter:title, twitter:description, twitter:image
- Hreflang: en, he, and x-default (pointing to English version) - ALL three required on EVERY page
- Page-specific CSS via pageStyles loop: `<% if (pageStyles) { pageStyles.forEach(s => { %><link rel="stylesheet" href="<%= s.href %>"<% if (s.media) { %> media="<%= s.media %>"<% } %> /><% }); } %>`

Use `<%= %>` (escaped) for all dynamic values. Reserve `<%- %>` only for includes. The og:image should use a default if ogImage is empty/null: `${baseUrl}/imgs/website-images/og-default.jpg`.

Add a `baseUrl` variable that the partial expects (passed from route handlers).
  </action>
  <verify>
Create a simple test: temporarily modify the existing test route at `/:lang(en|he)/test` to pass meta-tags variables and render the partial. Check that `curl http://localhost:4000/en/test` output contains og:title, canonical, hreflang tags. Revert the test route after verification.

Alternatively, verify by inspection: the EJS syntax is valid (no unclosed tags), all required meta tags are present, character counts on descriptions are within 120-158 range.
  </verify>
  <done>backend/config/meta.js exports bilingual meta for 5 pages, backend/views/partials/meta-tags.ejs renders all SEO tags with proper escaping</done>
</task>

<task type="auto">
  <name>Task 2: Rebuild header and footer partials to match frontend HTML</name>
  <files>backend/views/partials/header.ejs, backend/views/partials/footer.ejs</files>
  <action>
Replace the minimal header.ejs and footer.ejs created in Phase 23-01 with full versions matching the existing frontend HTML structure.

**header.ejs** must match the structure in frontend/index.html and frontend/html/about.html:
- Outer `<header>` with `<div class="site-header" data-purpose="site-header">`
- Left section: hamburger menu icon (menubars-svg), site brand link (`<a class="site-brand" href="/<%= urlLang %>/">`)
- Center section: `<nav class="menu" aria-label="Primary">` (empty - JS populates categories)
- Right section: shopping cart icon with link to `/<%= urlLang %>/cart`, cart number badge
- SVG symbols for menu bars, close button, shopping cart (inline SVGs from existing HTML)
- The header receives: lang (eng/heb), dir (ltr/rtl), urlLang (en/he)
- Use urlLang for href paths (en/he), lang for content language checks (eng/heb)

**footer.ejs** must match the structure in frontend/html/about.html footer:
- `<footer class="footer">` with `<div class="columns-container">`
- Left column: Home link + category links (necklaces, crochet-necklaces, hoops, dangle, bracelets, unisex) - use clean URLs `/<%= urlLang %>/categories/necklaces` etc. (these will be implemented in Phase 25, for now link to legacy paths that will redirect)
- Middle column: policies link, contact link
- Right column: workshop link, about link
- Rights container with copyright text
- Footer receives: lang (eng/heb), urlLang (en/he)
- Bilingual text: link labels in correct language based on lang variable

Important: The header/footer HTML class names and structure MUST match exactly what the existing CSS expects (site-header, site-header__left, site-header__center, site-header__right, menubars-svg, site-brand, site-logo-text, shoppingcart-container, etc.). The client-side JS will enhance these elements after page load.

For category links in footer, use the NEW clean URL format: `/<%= urlLang %>/necklaces`, `/<%= urlLang %>/crochet-necklaces`, etc. These will be SSR'd in Phase 25. For now they can 404 - the legacy redirect middleware will catch old .html paths.
  </action>
  <verify>Manually inspect that the header.ejs has all CSS classes from the original HTML (site-header, site-header__left, site-header__center, site-header__right, menubars-svg, site-brand, site-logo-text). Verify footer has columns-container, footer-left-column, footer-middle-column, footer-right-column. Verify all href values use urlLang variable.</verify>
  <done>Header partial renders full navigation with correct CSS classes and bilingual content. Footer partial renders category/page links with correct CSS classes. Both match the existing frontend HTML structure that CSS and JS expect.</done>
</task>

</tasks>

<verification>
- backend/config/meta.js exists and exports meta for 5 pages in 2 languages
- meta-tags.ejs contains og:title, og:description, og:image, og:url, og:type, og:locale
- meta-tags.ejs contains twitter:card, twitter:title, twitter:description, twitter:image
- meta-tags.ejs contains 3 hreflang links (en, he, x-default)
- meta-tags.ejs contains link rel="canonical"
- header.ejs contains site-header, site-brand, menubars-svg classes
- footer.ejs contains columns-container, footer-left-column classes
- All dynamic values use `<%= %>` (escaped), only includes use `<%- %>`
</verification>

<success_criteria>
Meta configuration and all shared partials are ready for page templates in Plans 02 and 03 to include without duplication.
</success_criteria>

<output>
After completion, create `.planning/phases/24-static-page-ssr-meta-tags-deployment-merge/24-01-SUMMARY.md`
</output>
